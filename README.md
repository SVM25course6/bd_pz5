# OpenFoodFacts GUI - Полная документация функций

## Обзор приложения

Графическое приложение для поиска информации о пищевой ценности продуктов через API OpenFoodFacts. Реализовано на PyQt6 с поддержкой двух режимов поиска: по штрихкоду и по названию.

## Функции API

### `get_product_by_barcode(barcode: str, fields=None, lang="ru", country="ru") -> dict`
**Назначение**: Получение данных о продукте по штрихкоду через API v2 OpenFoodFacts.

**Параметры:**
- `barcode` (str) - штрихкод продукта
- `fields` (list/str, optional) - список полей для запроса (по умолчанию основные поля продукта)
- `lang` (str) - язык интерфейса (по умолчанию "ru")
- `country` (str) - страна (по умолчанию "ru")

**Возвращает:**
- `dict` - JSON-ответ от API с данными продукта

**Исключения:**
- `requests.exceptions.RequestException` - при ошибках сети
- `requests.exceptions.HTTPError` - при HTTP ошибках

### `search_products(query: str, page_size=5, fields=None, lang="ru", country="ru") -> dict`
**Назначение**: Поиск продуктов по текстовому запросу через Search API v2.

**Параметры:**
- `query` (str) - поисковый запрос
- `page_size` (int) - количество результатов на странице (по умолчанию 5)
- `fields` (list/str, optional) - список полей для запроса
- `lang` (str) - язык интерфейса
- `country` (str) - страна

**Возвращает:**
- `dict` - JSON-ответ с результатами поиска

## Функции обработки данных

### `extract_kcal(nutriments: dict) -> dict`
**Назначение**: Извлечение данных о калорийности и БЖУ из словаря питательных веществ.

**Параметры:**
- `nutriments` (dict) - словарь с данными о питательных веществах из API

**Возвращает:**
- `dict` - отфильтрованный словарь с данными на 100г и на порцию

**Извлекаемые поля:**
- `kcal_100g` - калории на 100г
- `protein_100g` - белки на 100г
- `fat_100g` - жиры на 100г
- `carbs_100g` - углеводы на 100г
- `kcal_serving` - калории на порцию
- `protein_serving` - белки на порцию
- `fat_serving` - жиры на порцию
- `carbs_serving` - углеводы на порцию

### `format_product_details(product: dict) -> str`
**Назначение**: Форматирование информации о продукте в читаемый текст для отображения.

**Параметры:**
- `product` (dict) - словарь с данными продукта

**Возвращает:**
- `str` - отформатированная многострочная строка с информацией о продукте

**Форматируемые данные:**
- Основная информация: название, бренд, штрихкод, упаковка, порция
- Питательные вещества на 100г
- Питательные вещества на порцию (если доступно)

## Класс MainWindow

### Конструктор `__init__(self)`
**Назначение**: Инициализация главного окна приложения.

**Выполняемые действия:**
1. Установка заголовка и размеров окна
2. Настройка CSS стилей
3. Инициализация переменных
4. Создание и компоновка виджетов
5. Вызов начальной настройки режима

### `on_mode_changed(self, index: int)`
**Назначение**: Обработчик смены режима поиска.

**Параметры:**
- `index` (int) - индекс выбранного элемента в комбобоксе

**Логика:**
- Очистка предыдущих данных
- Скрытие/показ таблицы в зависимости от режима
- Обновление placeholder текста поля ввода

### `on_search_clicked(self)`
**Назначение**: Обработчик нажатия кнопки "Найти".

**Логика:**
1. Валидация введенного запроса
2. Определение текущего режима поиска
3. Вызов соответствующего метода поиска
4. Обработка исключений и вывод ошибок

### `search_by_barcode(self, barcode: str)`
**Назначение**: Выполнение поиска продукта по штрихкоду.

**Параметры:**
- `barcode` (str) - штрихкод для поиска

**Логика:**
1. Очистка предыдущих результатов
2. Вызов API функции `get_product_by_barcode`
3. Проверка наличия продукта
4. Форматирование и отображение результата

### `search_by_name(self, name: str)`
**Назначение**: Выполнение поиска продуктов по названию.

**Параметры:**
- `name` (str) - название продукта для поиска

**Логика:**
1. Очистка предыдущих результатов
2. Вызов API функции `search_products`
3. Заполнение таблицы результатами
4. Сохранение списка продуктов для последующего выбора

### `on_table_double_clicked(self, row: int, column: int)`
**Назначение**: Обработчик двойного клика по строке таблицы.

**Параметры:**
- `row` (int) - номер строки
- `column` (int) - номер колонки

**Логика:**
- Получение данных выбранного продукта
- Форматирование и отображение детальной информации

## Вспомогательные элементы

### Константы
- `BASE` (str) - базовый URL API OpenFoodFacts
- `HEADERS` (dict) - HTTP заголовки для запросов

### Функция `main()`
**Назначение**: Точка входа в приложение.

**Логика:**
1. Создание экземпляра QApplication
2. Создание и отображение главного окна
3. Запуск основного цикла приложения

## Используемые виджеты PyQt6

### QWidget
- Базовый класс для главного окна

### QVBoxLayout / QHBoxLayout
- Вертикальная и горизонтальная компоновка элементов

### QLabel
- Текстовые метки для интерфейса

### QLineEdit
- Поле ввода для поисковых запросов

### QPushButton
- Кнопка "Найти" для выполнения поиска

### QComboBox
- Выпадающий список для выбора режима поиска

### QTableWidget
- Таблица для отображения результатов поиска по названию

### QTableWidgetItem
- Элементы данных для таблицы

### QTextEdit
- Текстовое поле для отображения детальной информации о продукте

### QMessageBox
- Диалоговые окна для показа ошибок и уведомлений

## Обработка исключений

- `requests.exceptions.RequestException` - сетевые ошибки
- Общие исключения `Exception` - прочие ошибки
- Валидация пустых запросов

## Стилизация

Применяется CSS для кастомизации внешнего вида:
- Шрифты Arial, размер 12px
- Зеленые кнопки с hover-эффектом
- Серая цветовая схема для таблиц и текстовых полей
- Четкие границы и отступы
